{% extends "base.html" %}
{% load static %}
{% block content %}
<header>
  <nav class="navbar p-2 navbar-expand-lg navbar-dark custom_navbar">
    <div class="container-fluid">
      <!-- Logo -->
      <div>
        <a href="{% url "index" %}">
          <img class="img-fluid w-25 rounded" style="max-width: 220px;" src="{% static 'img/nalelogo.jpg' %}"
            alt="Logo">
        </a>
      </div>

      <!-- Mobile toggle -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar items -->
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <!-- Left links -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item mx-2">
            <a class="nav-link active" aria-current="page" href="{% url "index" %}">Home</a>
          </li>
          <li class="nav-item mx-2">
            <a class="nav-link" href="{% url "shop" %}">Shop</a>
          </li>
          <li class="nav-item mx-2">
            <a class="nav-link " href="{% url "about" %}">About</a>
          </li>
          <li class="nav-item mx-2">
            <a class="nav-link" href="{% url "information" %}">Info</a>
          </li>
        </ul>

        <form class="d-flex me-3 position-relative" method="get" role="search" action="{% url 'shop' %}"
          autocomplete="off">
          <input id="searchBox" class="form-control me-2" type="search" placeholder="Search products..."
            aria-label="Search" name="q" />
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>


        <a class="nav-link p-3" href="#" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas"
          aria-controls="cartOffcanvas">

          <!-- Cart Icon Wrapper -->
          <div class="position-relative d-inline-block">
            <!-- SVG Cart -->
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
              class="bi bi-cart text-white" viewBox="0 0 16 16">
              <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 
        0 0 1 .485.379L2.89 3H14.5a.5.5 
        0 0 1 .491.592l-1.5 8A.5.5 
        0 0 1 13 12H4a.5.5 
        0 0 1-.491-.408L2.01 3.607 1.61 
        2H.5a.5.5 0 0 1-.5-.5M3.102 
        4l1.313 7h8.17l1.313-7zM5 
        12a2 2 0 1 0 0 4 2 2 0 0 0 
        0-4m7 0a2 2 0 1 0 0 4 2 2 0 
        0 0 0-4m-7 1a1 1 0 1 1 0 2 
        1 1 0 0 1 0-2m7 0a1 1 0 1 1 
        0 2 1 1 0 0 1 0-2" />
            </svg>

            <!-- Dynamic Badge -->
            <span id="cart-count"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              0
            </span>
          </div>
        </a>

      </div>
    </div>
  </nav>
</header>

<div class="container-fluid text-center bgimage bg-dark mb-5">
    <img style=" max-width: 100vw;" class="w-100 vh-50 object-fit-cover" src="{% static "img/visitingcard2.png" %}" alt="">
</div>

<div class="slogan-container">
  <div class="slogan-text">
    STAY YOUNG EXPRESS YOUR INNER GLAMOUR</div>
</div>
<div class="container mt-4">
  <div class="row">
    
    <!-- Image Slider -->
    <div class="col-md-6 col-12">

      <div id="bannerCarousel" class="carousel slide" data-bs-ride="carousel">

        <!-- Indicators -->
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#bannerCarousel" data-bs-slide-to="0" class="active"></button>
          <button type="button" data-bs-target="#bannerCarousel" data-bs-slide-to="1"></button>
          <button type="button" data-bs-target="#bannerCarousel" data-bs-slide-to="2"></button>
        </div>

        <!-- Slide Images -->
        <div class="carousel-inner rounded">

          <div class="carousel-item active">
            <img src="{% static 'img/upcome1.png' %}" class="d-block w-100 img-fluid rounded" alt="Slide 1">
          </div>

          <div class="carousel-item">
            <img src="{% static 'img/upcome2.jpg' %}" class="d-block w-100 img-fluid rounded" alt="Slide 2">
          </div>

        </div>

        <!-- Controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#bannerCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </button>

        <button class="carousel-control-next" type="button" data-bs-target="#bannerCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon"></span>
        </button>

      </div>

    </div>

    <!-- Text Section -->
    <div class="col-md-6 col-12 mt-4 align-middle text-white text-center">
      <h2>Trusted Quality Herbal cosmetics</h2>
      <p>
        At Nale Cosmetics, we deliver Premium herbal cosmetic's and medicated
        products that offer exceptional value. Our commitment is to provide trustworthy,
        effective solutions that truly benefit your health and skincare needs.
      </p>
    </div>

  </div>
</div>

<div class="container text-white text-center mt-4">
  <h2>Comprehensive Service & External Care</h2>
  <p>We ensure seamless access to our products with dedicated services, focusing on enhancing
    your overall well-being and timeless skincare.
    Experience natural care designed for lasting health and beauty.</p>
</div>

<div class="container-fluid bg-dark py-4">
  <div class="row justify-content-center g-4">
    {% for product in products %}
    <div class="col-md-4 col-sm-6 col-6 d-flex justify-content-center product-card">
      <div class="card bg-dark border-light text-white text-center d-flex flex-column"
           style="width: 12rem; min-height: 20rem;">

        <!-- üñºÔ∏è Product Image -->
        <div style="height: 10rem; overflow: hidden;">
          {% if product.image %}
          <img src="{{ product.image.url }}" loading="lazy"
               class="card-img-top rounded mx-auto d-block"
               style="width: 100%; height: 100%; object-fit: cover;"
               alt="{{ product.title }}">
          {% else %}
          <img src="{% static 'img/default.jpg' %}" loading="lazy"
               class="card-img-top rounded mx-auto d-block"
               style="width: 100%; height: 100%; object-fit: cover;"
               alt="No image">
          {% endif %}
        </div>

        <!-- üì¶ Card Body -->
        <div class="card-body d-flex flex-column justify-content-between p-2 flex-grow-1">
          <h6 class="card-title">{{ product.title }}</h6>
          <p class="card-text fw-bold mb-2">‚Çπ{{ product.price }}</p>

          <!-- ‚úÖ View Button -->
          <button class="btn btn-outline-info btn-sm mb-2"
            data-bs-toggle="modal"
            data-bs-target="#productModal"
            data-title="{{ product.title }}"
            data-price="{{ product.price }}"
            data-description="{{ product.description}}"
            data-id="{{ product.id }}"
            data-image="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/default.jpg' %}{% endif %}">
            View
          </button>

          <!-- üõí Add to Cart -->
          <button class="btn btn-danger btn-sm add-to-cart-btn mt-auto" data-id="{{ product.id }}" type="button">
            Add to Cart
          </button>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>


<!-- ‚úÖ Cart Offcanvas -->
<div class="offcanvas offcanvas-end bg-dark text-white" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartLabel">
  <div class="offcanvas-header">
    <h5 id="cartLabel">üõí Your Cart</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body">
    <!-- Cart Items -->
    <ul id="cart-items" class="list-group list-group-flush"></ul>

    <!-- Total -->
    <div class="mt-3">
      <h6 id="cart-total">Total: ‚Çπ0</h6>
    </div>

    <!-- Address Field -->
    <div id="address-box" class="mt-3 d-none">
      <textarea id="user-address" class="form-control" rows="3" placeholder="Enter your delivery address"></textarea>
    </div>

    <!-- Buttons -->
    <div class="mt-3">
      <button id="buy-now" class="btn btn-success w-100 mt-2">
        Buy Now
      </button>
    </div>
  </div>
</div>

<!-- ‚úÖ Product Details Modal -->
<div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header border-secondary">
        <h5 class="modal-title" id="productModalLabel">Product Details</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row align-items-center">
          <!-- Product Image -->
          <div class="col-md-5 text-center">
            <img id="modal-image" src="" class="img-fluid rounded shadow" alt="Product Image">
          </div>

          <!-- Product Info -->
          <div class="col-md-7">
            <h4 id="modal-title" class="fw-bold"></h4>
            <p id="modal-price" class="text-success fw-bold fs-5"></p>
            <p id="modal-description" class="text-light small"></p>
          </div>
        </div>
      </div>
      <div class="modal-footer border-secondary">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button class="btn btn-danger add-to-cart-btn mt-auto" data-id="{{ product.id }}" type="button">Add to Cart</button>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const cartCount = document.getElementById("cart-count");
  const cartItemsList = document.getElementById("cart-items");
  const cartTotal = document.getElementById("cart-total");
  const modal = document.getElementById("productModal");
  const modalImage = document.getElementById("modal-image");
  const modalTitle = document.getElementById("modal-title");
  const modalPrice = document.getElementById("modal-price");
  const modalDescription = document.getElementById("modal-description");
  const modalAddToCartBtn = modal.querySelector(".add-to-cart-btn");

  // üõí Local cart object
  let cart = {};

  // ‚úÖ When "View" button clicked ‚Üí populate modal
  document.querySelectorAll("[data-bs-target='#productModal']").forEach(btn => {
    btn.addEventListener("click", function () {
      const title = this.dataset.title;
      const price = this.dataset.price;
      const description = this.dataset.description;
      const image = this.dataset.image;
      const id = this.dataset.id;

      modalTitle.textContent = title;
      modalPrice.textContent = "‚Çπ" + price;
      modalDescription.innerHTML = description.replace(/\n/g, "<br>");
      modalImage.src = image;

      // Store ID on modal Add-to-Cart button
      modalAddToCartBtn.dataset.id = id;
      modalAddToCartBtn.dataset.title = title;
      modalAddToCartBtn.dataset.price = price;
    });
  });

  // ‚úÖ Event delegation: handle *any* Add to Cart button (including modal)
  document.body.addEventListener("click", function (e) {
    if (e.target.classList.contains("add-to-cart-btn")) {
      const btn = e.target;
      const productId = btn.dataset.id;
      const title = btn.dataset.title || btn.closest(".card-body").querySelector(".card-title").innerText;
      const priceText = btn.dataset.price || btn.closest(".card-body").querySelector(".card-text").innerText.replace("‚Çπ", "");
      const price = parseFloat(priceText);

      // Add or increase quantity
      if (cart[productId]) {
        cart[productId].qty += 1;
      } else {
        cart[productId] = { title, price, qty: 1 };
      }

      updateCartUI();

      // Open cart automatically
      const offcanvas = new bootstrap.Offcanvas(document.getElementById("cartOffcanvas"));
      offcanvas.show();
    }
  });

  // ‚úÖ Update Cart UI
  function updateCartUI() {
    const totalCount = Object.values(cart).reduce((sum, item) => sum + item.qty, 0);
    if (cartCount) cartCount.textContent = totalCount;

    cartItemsList.innerHTML = "";
    let totalPrice = 0;
    Object.values(cart).forEach(item => {
      totalPrice += item.price * item.qty;
      const li = document.createElement("li");
      li.className = "list-group-item d-flex justify-content-between align-items-center bg-dark text-white border-secondary";
      li.innerHTML = `
        ${item.title} - ‚Çπ${item.price}
        <span class="badge bg-danger rounded-pill">x ${item.qty}</span>
      `;
      cartItemsList.appendChild(li);
    });

    cartTotal.textContent = "Total: ‚Çπ" + totalPrice;
  }

  // ‚úÖ Handle Buy Now ‚Üí WhatsApp
  document.getElementById("buy-now").addEventListener("click", function () {
    const addressBox = document.getElementById("address-box");
    const addressField = document.getElementById("user-address");

    if (addressBox.classList.contains("d-none")) {
      addressBox.classList.remove("d-none");
      addressField.focus();
      this.textContent = "Send to WhatsApp ‚úÖ";
    } else {
      let items = document.querySelectorAll("#cart-items li");
      let cartText = "";
      items.forEach((item, index) => {
        cartText += `${index + 1}. ${item.textContent}\n`;
      });

      let total = document.getElementById("cart-total").textContent;
      let address = addressField.value.trim();
      if (address === "") {
        alert("‚ö†Ô∏è Please enter your address before sending!");
        return;
      }

      let phone = "918300299101"; // ‚úÖ Change to your WhatsApp number
      let message = `üõí Order Details:\n${cartText}\n${total}\n\nüìç Address:\n${address}`;
      let whatsappURL = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, "_blank");
    }
  });
});
</script>
<div class="container mt-4 p-2">
  <div class="row align-items-center">
    
    <!-- Carousel Column -->
    <div class="col-md-6 col-12 mb-4 mb-md-0">
      <div class="p-3 bg-dark border border-light rounded-3 shadow-sm">
        <div id="bannerCarousel" class="carousel slide" data-bs-ride="carousel">
          <div class="carousel-inner">
            {% for newproducts in newproducts %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <img 
                src="{{ newproducts.image.url }}" 
                class="d-block w-100 rounded-2"
                style="height: 350px; object-fit: cover;">
            </div>
            {% endfor %}
          </div>

          <!-- Controls -->
          <button class="carousel-control-prev" type="button" data-bs-target="#bannerCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#bannerCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
    </div>

    <!-- Text Column -->
    <div class="col-md-6 col-12 text-white text-center">
      <h2 class="fw-bold mb-3">Upcoming Updates</h2>
      <p class="px-3">
        Your favourite <strong>'Nale'</strong> products are on the way to inspire your day.
        Stay tuned for exciting launches packed with natural ingredients and innovative formulas 
        crafted for your skin‚Äôs health.
      </p>
      <a class="btn btn-info mt-2 px-4 py-2 rounded-pill" href="{% url 'upcoming_products' %}">
        View
      </a>
    </div>

  </div>
</div>

  <footer>
<!-- Footer Section -->
<div class="container-fluid bg-dark text-white mt-4 pt-5 pb-4">

  <!-- Row 1: Logo -->
  <div class="row mb-4">
    <div class="col-12 d-flex align-items-center">
      <a href="#">
        <img class="img-fluid rounded ms-md-5" style="max-width: 60px;" src="{% static 'img/nalelogo.jpg' %}" alt="Logo">
      </a>
    </div>
  </div>

<div class="container text-white py-4">

  <!-- Row 1: Contact Heading -->
  <div class="row mb-3">
    <div class="col-12 text-center">
      <h4 class="fw-bold">Contact Us</h4>
    </div>
  </div>

  <!-- Row 2: Contact Info -->
  <div class="row justify-content-center text-center text-md-center">
    <div class="col-12 col-md-8">

            <!-- Phone Numbers -->
      <p class="mb-2 text-md-center text-end">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-2"
          viewBox="0 0 16 16">
          <path
            d="M13.601 2.326A7.86 7.86 0 0 0 8 0a7.94 7.94 0 0 0-6.854 12.082L0 16l4.061-1.068A7.94 7.94 0 0 0 8 16h.003A7.94 7.94 0 0 0 16 8a7.86 7.86 0 0 0-2.399-5.674zM8.003 14.6a6.61 6.61 0 0 1-3.356-.92l-.24-.144-2.406.632.643-2.344-.156-.24A6.61 6.61 0 1 1 14.6 8c0 3.63-2.97 6.6-6.597 6.6z" />
          <path
            d="M11.05 9.293c-.188-.094-1.11-.55-1.283-.612-.172-.063-.297-.094-.422.094s-.484.612-.594.737-.219.141-.406.047c-.188-.094-.793-.292-1.51-.93-.558-.498-.934-1.113-1.043-1.301-.109-.188-.012-.289.082-.383.084-.084.188-.219.281-.328.094-.109.125-.188.188-.313.063-.125.031-.234-.016-.328-.047-.094-.422-1.015-.578-1.391-.152-.364-.309-.315-.422-.32l-.359-.006a.69.69 0 0 0-.5.234c-.172.188-.656.64-.656 1.563s.672 1.813.766 1.938c.094.125 1.32 2.016 3.203 2.828.448.193.797.309 1.07.395.449.143.859.123 1.18.075.359-.053 1.11-.453 1.27-.891.156-.438.156-.812.109-.891-.047-.078-.172-.125-.36-.219z" />
        </svg>
        +91 9025336009&nbsp;<br>&nbsp;+91 8300299101
      </p>

      <!-- Address -->
      <p class="mb-2 text-center">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-2"
          viewBox="0 0 16 16">
          <path
            d="M8.354 1.146a.5.5 0 0 0-.708 0L1.5 7.293V14.5A1.5 1.5 0 0 0 3 16h10a1.5 1.5 0 0 0 1.5-1.5V7.293l-6.146-6.147zM2.5 8.207l5.5-5.5 5.5 5.5V14a.5.5 0 0 1-.5.5h-10A.5.5 0 0 1 2.5 14V8.207z" />
        </svg>
        Kalkulam Taluk,<br> Kanyakumari District,<br> Tamil Nadu - 629 174, <br>India
      </p>


      <!-- Email -->
      <p class="mb-3 text-md-center text-end">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-2"
          viewBox="0 0 16 16">
          <path
            d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4z" />
          <path
            d="M.05 4.555L8 9.414l7.95-4.86A1.99 1.99 0 0 0 14 4H2c-.69 0-1.29.35-1.65.555z" />
        </svg>
        <a href="mailto:nalehcosmetic@gmail.com" class="text-white text-decoration-none">
          nalehcosmetic@gmail.com
        </a>
      </p>

    </div>
  </div>
</div>

  <!-- Row 3: Social Icons -->
  <div class="row justify-content-center text-center">
    <div class="col-12">
      <h5 class="fw-bold mb-3">Follow Us</h5>
      <div class="social-links d-flex justify-content-center flex-wrap gap-3">
        <a href="https://www.youtube.com/@Nalehcosmetics" class="text-white text-decoration-none">
          <i class="bi bi-youtube fs-4"></i>
          <span class="d-block small">NalehCosmetic's</span>
        </a>
        <a href="https://www.facebook.com/share/p/1JiNyWu5eo/" class="text-white text-decoration-none">
          <i class="bi bi-facebook fs-4"></i>
          <span class="d-block small">Nalehcosmetic's</span>
        </a>
        <a href="https://www.instagram.com/naleh.cosmetics?utm_source=qr&igsh=MXEzaHNocnBxYTE5eQ==" class="text-white text-decoration-none">
          <i class="bi bi-instagram fs-4"></i>
          <span class="d-block small">@nalehcosmetics</span>
        </a>
      </div>
    </div>
  </div>

</div>

<!-- Full-width Contact Form -->
<div class="container-fluid bg-dark text-white py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card bg-dark border-light text-white p-4 shadow-sm">
          <h5 class="mb-4 text-center">Send Us a Message</h5>

          {% if messages %}
            {% for msg in messages %}
              <div class="alert alert-{{ msg.tags }}">{{ msg }}</div>
            {% endfor %}
          {% endif %}

          <form action="" method="post">
            {% csrf_token %}
            <div class="mb-3">
              <input type="text" name="name" class="form-control" placeholder="Your Name" required>
            </div>
            <div class="mb-3">
              <input type="email" name="email" class="form-control" placeholder="Your Email" required>
            </div>
            <div class="mb-3">
              <!-- ‚úÖ Added ID to target in JS -->
              <textarea id="messageBox" name="message" class="form-control" rows="4" placeholder="Message (max 100 words)" required></textarea>
              <small id="wordCount" class="text-secondary d-block mt-1">0 / 100 words</small>
            </div>
            <button type="submit" class="btn btn-primary w-100">Send Message</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const textarea = document.getElementById("messageBox");
  const counter = document.getElementById("wordCount");
  const maxWords = 100;

  textarea.addEventListener("input", function() {
    // Split by whitespace, filter out empty items
    let words = textarea.value.trim().split(/\s+/).filter(w => w.length > 0);
    let count = words.length;

    if (count > maxWords) {
      // Prevent more than 100 words
      textarea.value = words.slice(0, maxWords).join(" ");
      count = maxWords;
    }

    // Update display
    counter.textContent = `${count} / ${maxWords} words`;
    counter.style.color = count >= maxWords ? "red" : "gray";
  });
});
</script>

<div class="container">
  <div class="row mt-4">
    <div class="col-12">
      <div class="text-center border-top border-secondary pt-3">
        <h6 class="mb-2 small text-white-50">¬© 2025 NalehCosmetics. All Rights Reserved</h6>
      </div>
    </div>
  </div>
</div>


  {% endblock %}






